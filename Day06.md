# PING? Ping! ping...

## ping を使いこなす

**今回利用する道具**

* ping

## ping 利用環境
- workspace - 10.0.2.4
- other pc  - 10.0.2.5 - windows clients (same network)
- tnitter   - 10.0.2.6 - Ubuntu LAMP server

## ping success message

[ping {ip address}]
```
C:\Users\IEUser>ping 10.0.2.6

10.0.2.6 に ping を送信しています 32 バイトのデータ:
10.0.2.6 からの応答: バイト数 =32 時間 =1ms TTL=64
10.0.2.6 からの応答: バイト数 =32 時間 <1ms TTL=64
10.0.2.6 からの応答: バイト数 =32 時間 <1ms TTL=64
10.0.2.6 からの応答: バイト数 =32 時間 <1ms TTL=64

10.0.2.6 の ping 統計:
    パケット数: 送信 = 4、受信 = 4、損失 = 0 (0% の損失)、
ラウンド トリップの概算時間 (ミリ秒):
    最小 = 0ms、最大 = 1ms、平均 = 0ms
```
```
point :
・[10.0.2.6] PC まで疎通確認(Connectivity test) Success
・32byte の packet を 往復させた時間 1ms 未満(<1ms)
・TTL(Time To Live) windows 128/ Linux 64 - router経由で１減少->Router経由なし
・統計情報から network は安定(Loss 0)
  ->[10.0.2.6] Linux server は 正常に稼働中で、network にも影響なし
```

[ping {hostname}]
```
C:\Users\IEUser>ping tnitter

tnitter [10.0.2.6]に ping を送信しています 32 バイトのデータ:
10.0.2.6 からの応答: バイト数 =32 時間 =1ms TTL=64
10.0.2.6 からの応答: バイト数 =32 時間 <1ms TTL=64
10.0.2.6 からの応答: バイト数 =32 時間 <1ms TTL=64
10.0.2.6 からの応答: バイト数 =32 時間 <1ms TTL=64

10.0.2.6 の ping 統計:
    パケット数: 送信 = 4、受信 = 4、損失 = 0 (0% の損失)、
ラウンド トリップの概算時間 (ミリ秒):
    最小 = 0ms、最大 = 1ms、平均 = 0ms
```
```
point :
・hostname から ip address を検知して、疎通確認(Connectivity test)
```

[ping -a {ip address}]
```
C:\Users\IEUser>ping -a 10.0.2.6

TNITTER [10.0.2.6]に ping を送信しています 32 バイトのデータ:
10.0.2.6 からの応答: バイト数 =32 時間 <1ms TTL=64
10.0.2.6 からの応答: バイト数 =32 時間 <1ms TTL=64
10.0.2.6 からの応答: バイト数 =32 時間 <1ms TTL=64
10.0.2.6 からの応答: バイト数 =32 時間 <1ms TTL=64

10.0.2.6 の ping 統計:
    パケット数: 送信 = 4、受信 = 4、損失 = 0 (0% の損失)、
ラウンド トリップの概算時間 (ミリ秒):
    最小 = 0ms、最大 = 0ms、平均 = 0ms
```
```
point :
・[-a] option  をつけることで、そのIP の Hostname を表示することが出来る。

注意：
・network 内で hostname が共有されている事が前提
```

[ping -l 60000 {ip address}]
```
C:\Users\IEUser>ping -l 60000 10.0.2.6

10.0.2.6 に ping を送信しています 60000 バイトのデータ:
10.0.2.6 からの応答: バイト数 =60000 時間 =2ms TTL=64
10.0.2.6 からの応答: バイト数 =60000 時間 =2ms TTL=64
10.0.2.6 からの応答: バイト数 =60000 時間 =1ms TTL=64
10.0.2.6 からの応答: バイト数 =60000 時間 =1ms TTL=64

10.0.2.6 の ping 統計:
    パケット数: 送信 = 4、受信 = 4、損失 = 0 (0% の損失)、
ラウンド トリップの概算時間 (ミリ秒):
    最小 = 1ms、最大 = 2ms、平均 = 1ms
```
```
point :
・[-l] option で ping で送るpacket size を指定する事が出来る
・60000 byte の 大きなsize の packet を 通信挿せる事で、経過時間から 帯域幅 を計算する

注意 ：
・この方法で 帯域を調査するのは、かなり概算。
  特に、上記の例のような高速なnetworkでは
  packet の 通信速度以外の 時間の影響が 大きくなり 概算も order で間違う可能性がある
```

[帯域の計算]
```
pingによる帯域の概算方法
帯域≒(60000[byte]*2) / 0.002[s] ≒ 60[Mbyte/s]
　　　{packet量*往復} / {平均時間} 
```

## ping error message

[ping {no address}]
```
C:\Users\IEUser>ping 10.0.2.7

10.0.2.7 に ping を送信しています 32 バイトのデータ:
10.0.2.4 からの応答: 宛先ホストに到達できません。
10.0.2.4 からの応答: 宛先ホストに到達できません。
10.0.2.4 からの応答: 宛先ホストに到達できません。
10.0.2.4 からの応答: 宛先ホストに到達できません。

10.0.2.7 の ping 統計:
    パケット数: 送信 = 4、受信 = 4、損失 = 0 (0% の損失)、
```
```
point :
・この network 環境に [10.0.2.7] の address を持つPC は存在しない。
・上記の error message は [Host] となるPC が、そもそも存在しない可能性を示唆

注意：
・error message の ３番目の例で Host が停止している場合を示すが、
  長期間 停止している Host の場合、network上の記録から抹消されているため
  今回の例のようなmessage になる場合もあるので注意
```

[ping {misstake input hostname}]
```
C:\Users\IEUser>ping tinitter
ping 要求ではホスト tinitter が見つかりませんでした。ホスト名を確認してもう一度
実行してください。
```
```
point : 
・[hostname] を指定して、その[Host]PC が見つからなかった場合

想定：
・HostName の入力ミス(記述ミス)
・HostName が DNS 登録されていない。
・Network 上 認識されていない。
```

[ping {stop server}]
```
C:\Users\IEUser>ping 10.0.2.5

10.0.2.5 に ping を送信しています 32 バイトのデータ:
要求がタイムアウトしました。
要求がタイムアウトしました。
要求がタイムアウトしました。
要求がタイムアウトしました。

10.0.2.5 の ping 統計:
    パケット数: 送信 = 4、受信 = 0、損失 = 4 (100% の損失)、
```
```
point：
・これは、［10.0.2.5］の address を DHCP で付与されていたPCが停止した状態
・これまでの ping の結果と異なり、［損失］(packet loss) が発生している。
```

[ping -i 1 {ip address}] TTL over
```
C:\Users\IEUser>ping -i 1 fornow

fornow.workslan [172.27.11.223]に ping を送信しています 32 バイトのデータ:
10.0.2.1 からの応答: 転送中に TTL が期限切れになりました。
10.0.2.1 からの応答: 転送中に TTL が期限切れになりました。
10.0.2.1 からの応答: 転送中に TTL が期限切れになりました。
10.0.2.1 からの応答: 転送中に TTL が期限切れになりました。

172.27.11.223 の ping 統計:
    パケット数: 送信 = 4、受信 = 4、損失 = 0 (0% の損失)、
```
```
point :
・TTL(Time To Live) ： Router を超える都度 Count が１つ減少する

*上記は、error message を表示させるために、強制的に[-i] option でTTL 初期値を １ に設定
・Windows は TTL 128 / Linux は TTL 64 を初期値として TTL のCountを測る
```

## 帯域(bps) - 補足説明

帯域(bps)
```
(1秒間にどれだけ多くのbit(情報)を送信できるかを示す)

速度？というとイメージ的に誤解が生じるので注意！
１bitの信号が相手に届くまでの時間はbpsの値に関わらず同じ

イメージ的には、道路の幅が広い方が、多くの情報を一度に送ることができる。
その一度に送ることができbit量を示します。
結果、帯域の値が大きいほど、通信処理は早く終了します。

※この環境では、pingの時間が早すぎることから、
　ICMPのEcho処理よりも、他の処理が影響し過ぎているはず。
　概算としても正しく計測できていない。
※帯域を測定するツール等は多々あるので
　こういう方法もあるという程度に覚えておくこと。
```
